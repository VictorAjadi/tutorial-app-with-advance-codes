import{r as c,j as e,d as V,A as G,b as P,p as b,e as U,M as W,_ as j,Z}from"./index-C4rIzEKt.js";import{c as m,u as x,P as R}from"./Pagination-rLQLugVK.js";const A=s=>c.forwardRef((t,a)=>e.jsx("div",{...t,ref:a,className:m(t.className,s)})),T=c.forwardRef(({className:s,bsPrefix:t,as:a="div",...n},r)=>(t=x(t,"card-body"),e.jsx(a,{ref:r,className:m(s,t),...n})));T.displayName="CardBody";const S=c.forwardRef(({className:s,bsPrefix:t,as:a="div",...n},r)=>(t=x(t,"card-footer"),e.jsx(a,{ref:r,className:m(s,t),...n})));S.displayName="CardFooter";const I=c.createContext(null);I.displayName="CardHeaderContext";const L=c.forwardRef(({bsPrefix:s,className:t,as:a="div",...n},r)=>{const h=x(s,"card-header"),u=c.useMemo(()=>({cardHeaderBsPrefix:h}),[h]);return e.jsx(I.Provider,{value:u,children:e.jsx(a,{ref:r,...n,className:m(t,h)})})});L.displayName="CardHeader";const H=c.forwardRef(({bsPrefix:s,className:t,variant:a,as:n="img",...r},h)=>{const u=x(s,"card-img");return e.jsx(n,{ref:h,className:m(a?`${u}-${a}`:u,t),...r})});H.displayName="CardImg";const B=c.forwardRef(({className:s,bsPrefix:t,as:a="div",...n},r)=>(t=x(t,"card-img-overlay"),e.jsx(a,{ref:r,className:m(s,t),...n})));B.displayName="CardImgOverlay";const D=c.forwardRef(({className:s,bsPrefix:t,as:a="a",...n},r)=>(t=x(t,"card-link"),e.jsx(a,{ref:r,className:m(s,t),...n})));D.displayName="CardLink";const q=A("h6"),M=c.forwardRef(({className:s,bsPrefix:t,as:a=q,...n},r)=>(t=x(t,"card-subtitle"),e.jsx(a,{ref:r,className:m(s,t),...n})));M.displayName="CardSubtitle";const _=c.forwardRef(({className:s,bsPrefix:t,as:a="p",...n},r)=>(t=x(t,"card-text"),e.jsx(a,{ref:r,className:m(s,t),...n})));_.displayName="CardText";const J=A("h5"),k=c.forwardRef(({className:s,bsPrefix:t,as:a=J,...n},r)=>(t=x(t,"card-title"),e.jsx(a,{ref:r,className:m(s,t),...n})));k.displayName="CardTitle";const E=c.forwardRef(({bsPrefix:s,className:t,bg:a,text:n,border:r,body:h=!1,children:u,as:y="div",...g},p)=>{const C=x(s,"card");return e.jsx(y,{ref:p,...g,className:m(t,C,a&&`bg-${a}`,n&&`text-${n}`,r&&`border-${r}`),children:h?e.jsx(T,{children:u}):u})});E.displayName="Card";const N=Object.assign(E,{Img:H,Title:k,Subtitle:M,Body:T,Link:D,Text:_,Header:L,Footer:S,ImgOverlay:B}),X=()=>{const[s,t]=c.useState(1),[a,n]=c.useState("idle"),[r,h]=c.useState(""),[u,y]=c.useState({attendedTo:[],notAttendedTo:[]}),g=5,[p,C]=c.useState(g),v=V(),o=v.reports;c.useEffect(()=>{const l=s*g,i=l-g;y(d=>({attendedTo:o!=null&&o.attendedTo?o==null?void 0:o.attendedTo.slice(i,l):d.attendedTo,notAttendedTo:o!=null&&o.notAttendedTo?o==null?void 0:o.notAttendedTo.slice(i,l):d.notAttendedTo})),C(d=>Math.ceil((o?$(o==null?void 0:o.attendedTo.length,o==null?void 0:o.notAttendedTo.length):d)/g))},[o,s]);const F=l=>{t(l)};function $(l,i){const d=[parseInt(l),parseInt(i)];return Math.max(...d)}const O=async l=>{const{id:i}=l.currentTarget;if(!r)return j.error("Enter the content of your mail...");n("submitting");const d=j.loading("Processing..."),f=await Z(i,{text:r});return n("idle"),j.remove(d),f.status==="success"&&f.message?j.success(f.message):j.error(f.message)};return e.jsxs("div",{className:"container mt-4",children:[e.jsx("h1",{className:"text-center mb-4",children:"Reports Management"}),e.jsx(G,{resolve:v.reports,children:()=>e.jsxs(e.Fragment,{children:[["attendedTo","notAttendedTo"].map((l,i)=>e.jsxs("div",{className:"bg-lightGray rounded-3 shadow my-4 p-3",children:[e.jsx("h3",{className:"m-3 fw-bold",children:l==="attendedTo"?"List of attended report":"List of unattended report"}),e.jsx("hr",{className:"border-3 border-secondary"}),u[l]&&u[l].map(d=>{var f,w;return e.jsxs(N,{className:"my-4 shadow bg-white rounded-2",children:[e.jsx(N.Header,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("h5",{children:["Report from: ",d.from.name]}),e.jsxs("span",{children:["Reported on: ",new Date(d.createdAt).toLocaleDateString()]})]})}),e.jsx(N.Body,{children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{children:e.jsx("strong",{children:"Report Content:"})}),e.jsx("p",{children:d.text})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{children:e.jsx("strong",{children:"Reported Course:"})}),e.jsx("p",{children:e.jsx("strong",{children:d.to.title})}),e.jsx("p",{children:d.to.description}),e.jsxs("div",{className:"d-inline-flex my-2 gap-3 flex-nowrap align-items-center",children:[e.jsx(P.LazyLoadImage,{src:((f=d.to.instructor)==null?void 0:f.profile_image)||b,height:"40px",width:"40px",className:"rounded-circle border-secondary border border-4",placeholderSrc:async()=>await U(d.to.thumbnailUrl||b),effect:"blur"}),e.jsx("p",{className:"text-secondary text-capitalize fs-5",children:e.jsx("strong",{children:(w=d.to.instructor)==null?void 0:w.name})})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Price:"})," ",d.to.amount," ",d.to.currency]})]})]})}),e.jsxs(N.Footer,{className:"d-flex justify-content-between",children:[l==="attendedTo"&&e.jsxs("span",{className:"text-muted",children:["Handled: ",d.attendToAt?new Date(d.attendToAt).toLocaleDateString():"Not handled yet"]}),l==="notAttendedTo"&&e.jsx(W,{courseId:d._id,buttonText:"Mark as Resolved",title:"Add response message",bStyles:"btn btn-primary border-0 text-light p-3 rounded-2 shadow",footer:e.jsx("button",{onClick:O,id:d._id,disabled:a==="submitting",type:"button",className:`btn ${a==="idle"?"btn-primary":a==="submitting"?"btn-secondary":"btn-danger"}`,children:"Process"}),children:e.jsx("div",{className:"row g-3 flex-wrap mx-auto w-100",children:e.jsxs("div",{className:"mb-3 col-12",children:[e.jsx("label",{htmlFor:"text",className:"form-label fw-medium text-secondary",children:"Enter attended mail message here"}),e.jsx("textarea",{name:"text",className:"form-control w-100",onChange:z=>h(z.target.value),value:r,id:"text",placeholder:"Enter message"})]})})})]})]},d._id)})]},i)),e.jsx(R,{className:"justify-content-center mt-4",children:Array.from({length:p},(l,i)=>e.jsx(R.Item,{active:i+1===s,onClick:()=>F(i+1),children:i+1},i+1))})]})})]})};export{X as default};
