import{_ as r,r as x,j as e,I as B,o as A}from"./index-u5watr16.js";import{R as q,m as S}from"./quillUtils-BHA0W18K.js";import{P as D}from"./ProgressBar-CNHIutLk.js";const O=(s,l)=>{if(!s.title)return l(!1),r.error("Please enter the course title.....");if(!s.description)return l(!1),r.error("Please enter the course description.....");if(!s.category)return l(!1),r.error("Please select the course category.....");if(!s.type)return l(!1),r.error("Please select the type of course, whether free or paid.....");if(s.type==="paid"&&s.currency==="")return l(!1),r.error("Select a currency for your paid course.....");if(s.type==="paid"&&s.amount==="")return l(!1),r.error("Enter an amount for your paid course.....");if(!s.skill_level)return l(!1),r.error("Please select the course skill level.....");if(!s.thumbnailUrl)return l(!1),r.error("Please select a thumbnail image for course.....");l(b=>!b)},Q=(s,l,b,w,U)=>{if(!s.title)return r.error("Please enter the video title.");if(!s.description)return r.error("Please enter the video description.");if(!s.part)return r.error("Please enter the part of this video, e.g., Part 1: Introduction to coding.");if(!s.videoUrl)return r.error("Please enter the course video file.");if(!s.duration)return r.error("Please enter the course video duration.");if(s.question&&!s.answer)return r.error("Please enter the answer for the assignment question.");if(s.answer&&!s.question)return r.error("Please enter the question for the assignment answer.");l(m=>({...m,tutorial:[...m.tutorial,s]})),w(0),b(m=>({title:"",description:"",part:"",duration:"",videoUrl:"",question:"",answer:""})),k(U)},k=s=>{s&&s.scrollIntoView({behavior:"smooth",block:"start"})};function M(){const[s,l]=x.useState(!1),[b,w]=x.useState(0),[U,m]=x.useState(0),[R,I]=x.useState("idle"),N=x.useRef(null),[t,v]=x.useState({title:"",description:"",category:"",thumbnailUrl:"",type:"",currency:"",amount:"",skill_level:"",tutorial:[]}),[i,f]=x.useState({title:"",description:"",part:"",videoUrl:"",duration:"",question:"",answer:""}),g=async a=>{const{name:o,value:n,type:j,files:y}=a.target,p=["image/jpeg","image/png","image/webp"];if(j==="file"){if(y[0]){const c=y[0];if(p.includes(c.type)){const h=new FileReader;h.onprogress=d=>{if(d.lengthComputable){const u=Math.round(d.loaded/d.total*100);w(u)}},h.readAsDataURL(c),v(d=>({...d,[o]:c}))}else{r.error("Invalid image format. Please upload a valid image file.");return}}}else v(c=>({...c,[o]:n}))},P=a=>{const{name:o,type:n,files:j}=a.target,y=["video/mp4","video/webm","video/ogg","video/avi","video/mov","video/mkv"];if(n==="file"&&j[0]){const p=j[0];if(!y.includes(p.type)){r.error("Invalid video format: Please upload a valid video file.");return}const c=document.createElement("video"),h=URL.createObjectURL(p);c.src=h;const d=new FileReader;d.onprogress=u=>{if(u.lengthComputable){const C=Math.round(u.loaded/u.total*100);m(C)}},d.readAsDataURL(p),f(u=>({...u,[o]:p})),c.addEventListener("loadedmetadata",()=>{const u=c.duration;f(C=>({...C,duration:u})),URL.revokeObjectURL(h)})}else f(p=>({...p,[o]:a.target.value}))},T=a=>{f(o=>({...o,question:a}))},_=a=>{f(o=>({...o,answer:a}))},E=async a=>{if(a.preventDefault(),!t.title)return r.error("Please enter the course title.");if(!t.description)return r.error("Please enter the course description.");if(!t.category)return r.error("Please select the course category.");if(!t.type)return r.error("Please select a type for your course, either free or paid.");if(!t.skill_level)return r.error("Please select the course skill level.");if(!t.thumbnailUrl)return r.error("Please select a thumbnail image for the course.");if(!t.amount&&t.type==="paid")return r.error("Please select the course price.");if(!t.currency&&t.type==="paid")return r.error("Please select a currency for the course.");if(!i.title)return r.error("Please enter the video title.");if(!i.description)return r.error("Please enter the video description.");if(!i.part)return r.error("Please enter the part of this video, e.g., Part 1: Introduction to coding.");if(i.question&&!i.answer)return r.error("Please enter the answer for the assignment question.");if(i.answer&&!i.question)return r.error("Please enter the question for the assignment answer.");I("submitting");const o=r.loading("Uploading in progress..."),n=new FormData;n.append("category",t.category),n.append("description",t.description),n.append("type",t.type),n.append("amount",t.amount),n.append("currency",t.currency),n.append("title",t.title),n.append("thumbnailUrl",t.thumbnailUrl),n.append("skill_level",t.skill_level);const j=t.tutorial.map(({videoUrl:d,...u})=>u),{videoUrl:y,...p}=i;n.append("tutorial",JSON.stringify([...j,p]));let c=t.tutorial.map(d=>d.videoUrl);c=[...c,y],c.forEach(d=>{n.append("videos",d)});const h=await A(n);return I("idle"),r.remove(o),h.status==="success"&&h.message?(v({title:"",description:"",category:"",thumbnailUrl:"",price:"",tutorial:[]}),r.success(h.message)):r.error(h.message)},L=x.useCallback(()=>{t.tutorial.length===1?(m(100),f(t.tutorial[0]),v(a=>({...a,tutorial:[]})),k(N.current)):t.tutorial.length===0?(m(0),l(!1),f({title:"",description:"",part:"",videoUrl:"",duration:"",question:"",answer:""}),v(a=>({...a,thumbnailUrl:""})),w(0)):(m(100),v(a=>{const o=a.tutorial.slice(0,-1);return{...a,tutorial:o}}),f(t.tutorial[t.tutorial.length-1]),k(N.current))},[t.tutorial]);return e.jsxs("div",{children:[e.jsx(B,{position:"top-center",reverseOrder:!1}),s===!1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"row g-3 mt-4",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("label",{htmlFor:"title",className:"fw-medium fs-5 text-secondary form-label",children:"Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:t.title,onChange:g,className:"form-control py-2",placeholder:"Title"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{htmlFor:"description",className:"fw-medium fs-5 text-secondary form-label",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:t.description,onChange:g,className:"form-control py-2",placeholder:"Description"})]}),e.jsxs("div",{className:"row g-2 justify-content-between",children:[e.jsxs("select",{name:"category",className:"p-2 col-3 rounded-3",id:"category",value:t.category,onChange:g,children:[e.jsx("option",{value:"",disabled:!0,className:"bg-secondary text-light",children:"Category"}),e.jsx("option",{value:"business",children:"Business"}),e.jsx("option",{value:"development",children:"Development"}),e.jsx("option",{value:"finance",children:"Finance"}),e.jsx("option",{value:"engineering",children:"Engineering"}),e.jsx("option",{value:"health_fitness",children:"Health & Fitness"}),e.jsx("option",{value:"lifestyle",children:"Lifestyle"}),e.jsx("option",{value:"art_design",children:"Art & Design"}),e.jsx("option",{value:"data_science",children:"Data Science"})]}),e.jsxs("select",{name:"skill_level",className:"p-2 col-3 rounded-3",id:"skill_level",value:t.skill_level,onChange:g,children:[e.jsx("option",{value:"",disabled:!0,className:"bg-secondary text-light",children:"skill level"}),e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"high",children:"High"})]}),e.jsxs("select",{name:"type",className:"p-2 col-3 rounded-3",id:"type",value:t.type,onChange:g,children:[e.jsx("option",{value:"",disabled:!0,className:"bg-secondary text-light",children:"Course Type"}),e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]}),t.type==="paid"?e.jsxs("div",{className:"w-100 mx-auto row g-3",children:[e.jsx("br",{}),e.jsxs("select",{name:"currency",className:"p-2 col-6 rounded-3",id:"currency",value:t.currency,onChange:g,children:[e.jsx("option",{value:"",disabled:!0,className:"bg-secondary text-light",children:"Currency"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"})]}),e.jsx("input",{type:"number",value:t.amount,onChange:g,name:"amount",className:"col-6 p-2 rounded-3",placeholder:"amount"})]}):e.jsx(e.Fragment,{})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{htmlFor:"thumbnailUrl",className:"fw-medium fs-5 text-secondary form-label",children:"Course Thumnail Image"}),e.jsx("input",{type:"file",id:"thumbnailUrl",name:"thumbnailUrl",className:"form-control py-2",accept:"image/*",placeholder:"Course Thumnail Image",onChange:g}),e.jsx(D,{progress:b})]})]})}),e.jsx("button",{type:"button",onClick:()=>O(t,l),className:"w-100 d-flex justify-content-center align-items-center my-4 fw-medium box-shadow rounded-pill p-2 fs-5",children:"Next"})]}),s&&e.jsx("div",{ref:N,children:e.jsxs("form",{className:"row g-3",onSubmit:E,children:[e.jsxs("div",{className:"row g-3 mt-4",children:[e.jsx("div",{className:"row g-3 ",children:e.jsxs("div",{className:"col",children:[e.jsx("label",{htmlFor:"title",className:"fw-medium fs-5 text-secondary form-label",children:"Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:i.title,onChange:P,className:"form-control py-2",placeholder:"Title"})]})}),e.jsxs("div",{className:"col-12",children:[e.jsxs("select",{name:"part",className:"p-2 w-100 rounded-3",id:"part",value:i.part,onChange:P,children:[e.jsx("option",{value:"",disabled:!0,className:"text-center bg-secondary text-light",children:"Group Videos In Part"}),e.jsx("option",{value:"part 1",children:"Part 1"}),e.jsx("option",{value:"part 2",children:"Part 2"}),e.jsx("option",{value:"part 3",children:"Part 3"}),e.jsx("option",{value:"part 4",children:"Part 4"}),e.jsx("option",{value:"part 5",children:"Part 5"}),e.jsx("option",{value:"part 6",children:"Part 6"})]}),e.jsx("p",{className:"text-secondary my-2",children:"Example: we can have 6 different videos in part 1"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{htmlFor:"description",className:"fw-medium fs-5 text-secondary form-label",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:i.description,onChange:P,className:"form-control py-2",placeholder:"Description"})]}),e.jsxs("div",{className:"col-12",style:{height:"350px"},children:[e.jsx("label",{htmlFor:"question",className:"fw-medium text-secondary fs-5 form-label",children:"Add assignment question on this video (if needed)"}),e.jsx(q,{style:{height:"200px",zIndex:"0",backgroundColor:"white"},className:"my-4",modules:S,theme:"snow",value:i.question,onChange:T})]}),e.jsxs("div",{className:"col-12 mt-5 pt-3",style:{height:"350px"},children:[e.jsx("label",{htmlFor:"answer",className:"fw-medium text-secondary fs-5 form-label",children:"Add assignment answer on this video"}),e.jsx(q,{style:{height:"200px",zIndex:"0",backgroundColor:"white"},modules:S,theme:"snow",value:i.answer,onChange:_})]})]}),e.jsxs("div",{className:"col-12 mt-4",children:[e.jsx("label",{htmlFor:"videoUrl",className:"fw-medium fs-5 text-secondary form-label",children:"Course Video"}),e.jsx("input",{type:"file",id:"videoUrl",name:"videoUrl",className:"form-control py-2",placeholder:"Course Video",accept:"video/*",onChange:P}),e.jsx(D,{progress:U})]}),e.jsx("p",{className:"text-secondary fs-5  fw-medium",children:"To add more video to the this course, click next..."}),e.jsxs("div",{className:"row g-3",children:[e.jsx("button",{type:"submit",disabled:R==="submitting",className:`w-100 d-flex justify-content-center align-items-center fw-medium rounded-pill p-2 fs-5 ${R==="submitting"?"bg-secondary":"box-shadow"}`,children:"Upload"}),e.jsx("button",{type:"button",onClick:()=>Q(i,v,f,m,N.current),className:"w-100 d-flex justify-content-center align-items-center fw-medium box-shadow rounded-pill p-2 fs-5",children:"Next"}),e.jsx("button",{type:"button",onClick:L,className:"w-100 d-flex justify-content-center align-items-center fw-medium box-shadow rounded-pill p-2 fs-5",children:"Back"})]})]})})]})}export{M as default};
