import{g as F,r as c,z as D,a as I,R as q,j as e,_ as n,E as T,D as G}from"./index-C4rIzEKt.js";import{R as y,m as N}from"./quillUtils-BM7t4XE-.js";import{P as M}from"./ProgressBar-DPWXu64Z.js";function Z(){const{course:m}=F(),[f,L]=c.useState(!1),[g,v]=c.useState("idle"),[k,j]=c.useState(0),[S,R]=c.useState(""),V=D(),w=I(t=>t.tutorialData),U=q.useCallback(t=>{j(0),R(t.currentTarget.id),L(i=>!i)},[]),[s,d]=c.useState({title:"",description:"",part:"",duration:"",videoUrl:"",question:"",answer:""}),p=t=>{const{name:i,type:h,files:a}=t.target,u=["video/mp4","video/webm","video/ogg","video/avi","video/mov","video/mkv"];if(h==="file"&&a[0]){const r=a[0];if(!u.includes(r.type)){n.error("Invalid video format: Please upload a valid video file.");return}const l=document.createElement("video"),b=URL.createObjectURL(r);l.src=b;const C=new FileReader;C.onprogress=o=>{if(o.lengthComputable){const x=Math.round(o.loaded/o.total*100);j(x)}},C.readAsDataURL(r),d(o=>({...o,[i]:r})),l.addEventListener("loadedmetadata",()=>{const o=l.duration;d(x=>({...x,duration:o})),URL.revokeObjectURL(b)})}else d(r=>({...r,[i]:t.target.value}))},_=t=>{d(i=>({...i,question:t}))},P=t=>{d(i=>({...i,answer:t}))};async function E(t){t.preventDefault();const i=t.target.id,h=m==null?void 0:m._id,a=new FormData;a.append("answer",s.answer),a.append("question",s.question),a.append("title",s.title),a.append("description",s.description),a.append("part",s.part),a.append("duration",s.duration),a.append("video",s.videoUrl),v("submitting");const u=n.loading("Updating..."),r=await T(h,i,a);if(v("idle"),r.status==="success"&&r.message){n.remove(u);const l={state:!w.state,tutorials:w.tutorials};return V(G(l)),n.success(r.message)}else return n.remove(u),n.error(r.message)}return e.jsx("div",{children:m.tutorial.map((t,i)=>e.jsxs("div",{className:"rounded-3 shadow p-3 bg-light my-4",children:[e.jsxs("div",{className:"d-flex flex-row justify-content-between align-items-start gap-4",children:[e.jsxs("svg",{viewBox:"0 0 24 24",width:"50px",height:"50px",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),e.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",e.jsx("path",{opacity:"0.5",fillRule:"evenodd",clipRule:"evenodd",d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",fill:"#1C274C"})," ",e.jsx("path",{d:"M15.4137 13.059L10.6935 15.8458C9.93371 16.2944 9 15.7105 9 14.7868V9.21316C9 8.28947 9.93371 7.70561 10.6935 8.15419L15.4137 10.941C16.1954 11.4026 16.1954 12.5974 15.4137 13.059Z",fill:"#1C274C"})," "]})]}),"                ",e.jsx("div",{className:"d-flex flex-column  justify-content-between align-items-start flex-fill",children:e.jsxs("p",{className:"fs-5 mt-2 fw-medium text-secondary",children:["Title: ",e.jsx("span",{className:"fs-6 fw-normal",children:t.title})]})}),e.jsx("button",{id:t._id,onClick:U,className:`btn ${f?"btn-primary":"btn-warning"} rounded-pill px-3 border border-0 text-light`,children:e.jsxs("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),e.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",e.jsx("path",{d:"M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H9M15 5H17C18.1046 5 19 5.89543 19 7V9",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{d:"M14.902 20.3343L12.7153 20.7716L13.1526 18.585C13.1914 18.3914 13.2865 18.2136 13.4261 18.074L17.5 14L19.5 12L21.4869 13.9869L19.4869 15.9869L15.413 20.0608C15.2734 20.2004 15.0956 20.2956 14.902 20.3343Z",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{d:"M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z",stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})," "]})]})})]}),f&&S.toString()===t._id&&e.jsx("div",{children:e.jsxs("form",{id:t._id,onSubmit:E,className:"row g-3",children:[e.jsxs("div",{className:"row g-3 mt-4",children:[e.jsx("div",{className:"row g-3 ",children:e.jsxs("div",{className:"col",children:[e.jsx("label",{htmlFor:"title",className:"fw-medium fs-5 text-secondary form-label",children:"Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:s.title||t.title,onChange:p,className:"form-control py-2",placeholder:"Title"})]})}),e.jsxs("div",{className:"col-12",children:[e.jsxs("select",{name:"part",className:"w-100 rounded-3 form-select",ariaLabel:"Default select example",id:"part",value:s.part||t.part,onChange:p,children:[e.jsx("option",{value:"",disabled:!0,className:"text-center bg-secondary text-light",children:"Group Videos In Part"}),e.jsx("option",{value:"part 1",children:"Part 1"}),e.jsx("option",{value:"part 2",children:"Part 2"}),e.jsx("option",{value:"part 3",children:"Part 3"}),e.jsx("option",{value:"part 4",children:"Part 4"}),e.jsx("option",{value:"part 5",children:"Part 5"}),e.jsx("option",{value:"part 6",children:"Part 6"})]}),e.jsx("p",{className:"text-secondary my-2",children:"Example: we can have 6 different videos in part 1"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{htmlFor:"description",className:"fw-medium fs-5 text-secondary form-label",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:s.description||t.description,onChange:p,className:"form-control py-2",placeholder:"Description"})]}),e.jsxs("div",{className:"col-12",style:{height:"350px"},children:[e.jsx("label",{htmlFor:"question",className:"fw-medium text-secondary fs-5 form-label",children:"Edit assignment question on this video (if needed)"}),e.jsx(y,{style:{height:"200px",zIndex:"0",backgroundColor:"white"},className:"my-4",modules:N,theme:"snow",value:s.question||t.assignment.question,onChange:_})]}),e.jsxs("div",{className:"col-12 mt-5 pt-3",style:{height:"350px"},children:[e.jsx("label",{htmlFor:"answer",className:"fw-medium text-secondary fs-5 form-label",children:"Edit assignment answer on this video"}),e.jsx(y,{style:{height:"200px",zIndex:"0",backgroundColor:"white"},modules:N,theme:"snow",value:s.answer||t.assignment.answer,onChange:P})]})]}),e.jsxs("div",{className:"col-12 mt-4",children:[e.jsx("label",{htmlFor:"videoUrl",className:"fw-medium fs-5 text-secondary form-label",children:"Course Video"}),e.jsx("input",{type:"file",id:"videoUrl",name:"videoUrl",className:"form-control py-2",placeholder:"Course Video",accept:"video/*",onChange:p})]}),e.jsx(M,{progress:k}),e.jsx("div",{className:"row g-3",children:e.jsx("button",{type:"submit",id:t._id,disabled:g==="submitting",className:`${g==="submitting"?"bg-secondary":"box-shadow"} w-100 d-flex justify-content-center align-items-center fw-medium rounded-pill p-2 fs-5`,children:"Upload"})})]})})]},i))})}export{Z as default};
